<!DOCTYPE html>

<!-- Store page for themes by Tim -->
{% load staticfiles %}

<html>
<head>
	<!-- Title the page and link the style sheet -->
	<title>Store Themes Page</title>
	<link rel="stylesheet" type="text/css" href="{% static 'CopingGame/style_store_page.css' %}">
<head>

<body style="background-color:{{ player.fav_bg }}; color:{{ player.fav_text }}"> <!-- Load players theme for page -->
<font size="6">

	<!-- Page in a table so it can scale to any screen without much issue -->
	<table id="page" align="center" style="background-color:{{ player.fav_bg }}; color:{{ player.fav_text }}">
		<tr>
			<!-- Table that has the user avatar, user name, and their tokens -->
			<table id="usertable" align="center" style="background-color:{{ player.fav_bg }}; color:{{ player.fav_text }}">
				<tr>
					<td rowspan="2" colspan="2"><img id="avatarPic" src="{{ player.avatarPic.url }}" width="120" height="90"></td>
					<td>
					{% if user.is_authenticated %}
						<!-- user information -->
						{{ user.get_username }}
						<br>
						Tokens: {{ player.tokens }}
						<br>
						<a href="/logout/" style="color:{{ player.fav_text }}">Logout
					{% else %}
						Not currently logged in, please log in.
					{% endif %}</td>
				</tr>		
				<tr>
					<td></td>
				</tr>
			</table>
		</tr>
		
		<!-- Page banner -->
		<tr>
			<h1>Welcome to the Store</h1>
		</tr>
		
		<!-- Links to Home, Help, and Profile pages -->
		<tr>
			<div id="links" align="center">
			<!-- The button to return to the home page -->
			<a href="/CopingGame/" style="text-decoration: none">
				<img src="{% static 'CopingGame/images/home1.jpg' %}" style="width:100px;height:100px;border:0" style="color:{{ player.fav_text }}">
			</a> 
			<= Press this button to go back to the Homepage.
			</div>
		</tr>
		
		<!-- Categories and Purchase areas -->
		<tr>
			<!-- Category button's on the left -->
			<div id="categories">
				<div style="text-decoration: underline" align="center">CATEGORIES</div>
					<ul id="catul">
					<li id="catli"><button class="current" id="theme">Themes</button></li>
					<li id="catli"><a href="/CopingGame/"><button class="other" id="up">User Pictures</button></a></li>
				</ul>
			</div>
	
			<!-- Main portion of the page that displays purchase options -->
			<div id="main">
				<div id="inner">
					<h2 style="color:{{ player.fav_text }}">Click on the "Purchase" button to buy the item to its left.<h2>

					<!-- Themes table -->
					<table class="cattable" id="themes" align="center">
		
						<tr>
							<td colspan="2" style="text-decoration:underline;color:{{ player.fav_text }}">Themes - 50 Tokens Each</td>
						</tr>
				
						<!-- Make list of all themes -->
						{% for item in items_list %}
							{% if item.category == "Themes" %}
					
								<!-- Make a row for each theme -->
								<tr>
									<!-- Have a preview of the theme in the left column -->
									<td bgcolor="{{ item.value1 }}" style="color:{{ item.value2 }}">PREVIEW</td>
									
									{% if item.itemName in purchase_list %}
										<td style="color:{{ player.fav_text }}">Found</td>
									{% endif %}
									
									{% if item in purchase_list %}
										<td style="color:{{ player.fav_text }}">Found</td>
									{% endif %}
									
									<!-- Check the players purchases -->
									{% for purchase in purchase_list %}
										{% if purchase.itemFKey.category == "Themes" %}
											<!-- See if they already own the item -->
											{% if purchase.itemFKey.itemName == item.itemName %}
												<td style="color:{{ player.fav_text }}">Already own.</td>
											{% endif %}
										{% endif %}
											
										<!-- If this is reached, then they don't own the item -->
										{% if forloop.last %}
											<!-- See if they have enough tokens for the item -->
											{% if player.tokens >= 50 %}
												<!-- Display purchase button -->
												<form action="" method="post">
													{% csrf_token %}
													<td><button type="submit" value="{{ item.itemName }}">Purchase</button></td>
												</form>
											<!-- If they don't have enough tokens, say they don't -->
											{% else %}
												<td style="color:{{ player.fav_text }}">Not enough tokens.</td>
											{% endif %}
										{% endif %}
									{% endfor %}
								</tr>
							{% endif %}
						{% endfor %}

					</table>			
				</div>
			</div>
		</tr>
	</table>

</body>
</html>